<link rel="import" href="../../vendor/polymer/polymer.html">
<link rel="import" href="../widgets/team-standings.html">
<link rel="import" href="../widgets/upcoming-events.html">
<link rel="import" href="../widgets/article-widget.html">
<link rel="import" href="../shared-styles.html">
<link rel="import" href="page-styles.html">


<dom-module id="landing-page">
    <style include="shared-styles"></style>
    <style include="page-styles"></style>

    <template>
        <aside class="sidebar">
            <team-standings class="widget" data="{{data}}"></team-standings>
            <upcoming-events class="widget" data="{{data}}"></upcoming-events>
        </aside>

        <main class="main">
            <template is="dom-repeat" items="[[articles]]" as="article">
                <article-widget class="widget" heading="[[article.title]]" image="[[article.image]]" body="[[article.body]]"></article-widget>
            </template>
        </main>
    </template>
</dom-module>


<script>
    Polymer({
        is: 'landing-page',

        properties: {
            articles: {
                type: Array,
                computed: 'computeArticles(data)'
            }
        },

        computeArticles: function(data) {
            return data.articles.sort(function(a, b) {
                a = parseDate(a.date);
                b = parseDate(b.date);
                return b - a; // latest date first
            });
        }
    });

    function parseDate(date) {
        var datetime = date.split(' ');
        var dateSegments = datetime[0].split('-');
        var timeSegments = datetime[1].split(':');
        var year = parseInt(dateSegments[2], 10);
        var month = parseInt(dateSegments[1], 10) - 1; // 0 == January
        var day = parseInt(dateSegments[0], 10);
        var hour = parseInt(timeSegments[0], 10);
        var minute = parseInt(timeSegments[1], 10);
        return new Date(year, month, day, hour, minute);
    }
</script>
